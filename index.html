<!DOCTYPE html>
<!-- saved from url=(0063)https://www.registertovote.service.gov.uk/register-to-vote/name -->
<html lang="en" ng-app="patientApp"><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">    

    <title ng-bind="pageTitle">
Enter Patient ID number
</title>

<script type="text/javascript">
      (function(){if(navigator.userAgent.match(/IEMobile\/10\.0/)){var d=document,c="appendChild",a=d.createElement("style");a[c](d.createTextNode("@-ms-viewport{width:auto!important}"));d.getElementsByTagName("head")[0][c](a);}})();
    </script>

    <!--[if gt IE 8]><!--><link href="./gov-uk-files/govuk-template.css" media="screen" rel="stylesheet" type="text/css"><!--<![endif]-->
    <!--[if IE 6]><link href="https://assets.registertovote.service.gov.uk/assets/d530da8d6263992e9a60e8558776c1b251b60165/template/stylesheets/govuk-template-ie6.css" media="screen" rel="stylesheet" type="text/css" /><![endif]-->
    <!--[if IE 7]><link href="https://assets.registertovote.service.gov.uk/assets/d530da8d6263992e9a60e8558776c1b251b60165/template/stylesheets/govuk-template-ie7.css" media="screen" rel="stylesheet" type="text/css" /><![endif]-->
    <!--[if IE 8]><link href="https://assets.registertovote.service.gov.uk/assets/d530da8d6263992e9a60e8558776c1b251b60165/template/stylesheets/govuk-template-ie8.css" media="screen" rel="stylesheet" type="text/css" /><![endif]-->

    <link href="./gov-uk-files/govuk-template-print.css" media="print" rel="stylesheet" type="text/css">

    <!--[if IE 8]>
    <script type="text/javascript">
      (function(){if(window.opera){return;}
       setTimeout(function(){var a=document,g,b={families:(g=
       ["nta"]),urls:["https://assets.registertovote.service.gov.uk/assets/d530da8d6263992e9a60e8558776c1b251b60165/template/stylesheets/fonts-ie8.css"]},
       c="https://assets.registertovote.service.gov.uk/assets/d530da8d6263992e9a60e8558776c1b251b60165/template/javascripts/vendor/goog/webfont-debug.js",d="script",
       e=a.createElement(d),f=a.getElementsByTagName(d)[0],h=g.length;WebFontConfig
       ={custom:b},e.src=c,f.parentNode.insertBefore(e,f);for(;h=h-1;a.documentElement
       .className+=' wf-'+g[h].replace(/\s/g,'').toLowerCase()+'-n4-loading');},0)
      })()
    </script>
    <![endif]-->
    <!--[if gte IE 9]><!-->
      <link href="./gov-uk-files/fonts.css" media="all" rel="stylesheet" type="text/css">
    <!--<![endif]-->


    <!--[if lt IE 9]>
      <script src="https://assets.registertovote.service.gov.uk/assets/d530da8d6263992e9a60e8558776c1b251b60165/template/javascripts/ie.js" type="text/javascript"></script>
    <![endif]-->

    <link rel="shortcut icon" href="./marys-custom/favicon_64x64.ico" type="image/x-icon">

    <link rel="apple-touch-icon-precomposed" href="./marys-custom/checklist-on-white.png">

    <link rel="apple-touch-icon" href="./marys-custom/checklist-on-white.png">

    <meta name="viewport" content="width=device-width, initial-scale=1">

    
<!--[if gt IE 8]><!--><link href="./gov-uk-files/application.css" media="screen" rel="stylesheet" type="text/css"><!--<![endif]-->
<!--[if IE 6]><link href="https://assets.registertovote.service.gov.uk/assets/d530da8d6263992e9a60e8558776c1b251b60165/stylesheets/application-ie6.css" media="screen" rel="stylesheet" type="text/css" /><![endif]-->
<!--[if IE 7]><link href="https://assets.registertovote.service.gov.uk/assets/d530da8d6263992e9a60e8558776c1b251b60165/stylesheets/application-ie7.css" media="screen" rel="stylesheet" type="text/css" /><![endif]-->
<!--[if IE 8]><link href="https://assets.registertovote.service.gov.uk/assets/d530da8d6263992e9a60e8558776c1b251b60165/stylesheets/application-ie8.css" media="screen" rel="stylesheet" type="text/css" /><![endif]-->

<link href="./gov-uk-files/print.css" media="print" rel="stylesheet" type="text/css">

<link href="./marys-custom/marys.css" media="screen" rel="stylesheet" type="text/css">
<script src="./marys-custom/underscore.js"></script>

<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.3.10/angular.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.3.10/angular-animate.js"></script>
<script type="text/javascript">

var additionalSearchTerms = { // 78
  "A keyhole or laparoscopic operation had to be converted to open": "",
  "A test, surgical intervention or therapy was performed on the wrong site of your body.": "",
  "A test or procedure was interrupted by Equipment malfunction": "",
  "A test was cancelled by mistake": "",
  "A test was not done when it should have been": "",
  "A test was repeated needlessly, by mistake": "",
  "An error occurred in a test result": "",
  "An infusion or drug was omitted, by mistake.": "",
  "Cellulitis": "",
  "C.diff colitis": "",
  "Doctors made a wrong diagnosis": "",
  "Doctors or nurses did not respect confidentiality": "",
  "Doctors or nurses ignored information you gave them": "",
  "Failure to order drug": "",
  "Health care staff did not introduce themselves and explain who they were": "",
  "Intra-abdominal abscess": "",
  "Phlebitis": "",
  "Pneumonia": "",
  "Problems with environment and amenities. In what?": "",
  "Sepsis / bacteraemia": "",
  "Something was inappropriately left inside you (retained foreign body)": "",
  "Staff were unable to obtain a blood sample": "",
  "The wrong implant or prosthesis was used": "",
  "The purpose of the medication was not explained to you": "",
  "The side effects of your medication were not explained to you": "",
  "There was a delay in giving you your medication": "",
  "Urinary tract infection": "",
  "Wound infection": "",
  "You bled a lot after an operation or after a tube or drain was inserted into you": "",
  "You developed a collection of blood (haematoma) or fluid (seroma) at the site of an operation or procedure": "",
  "You developed a DVT (deep vein thrombosis) or PE (pulmonary embolism)": "",
  "You developed a sore arm or inflammation because of a drip (intravenous line)": "",
  "You developed a pressure ulcer (skin wound) in hospital": "",
  "You developed worsened anxiety or depression": "",
  "You developed problems passing urine (oliguria/ failure/ incontinence / retention)": "",
  "You developed a collapsed lung or pneumothorax after a procedure": "",
  "You did not receive enough painkillers": "",
  "You did not feel that you could ask questions to doctors and nurses if you wanted to": "",
  "You discovered that staff did not wash their hands or use alcohol gel before touching you.": "",
  "You experienced a reaction to a drug": "",
  "You experienced unexplained waits and delays. In what? For how long?": "",
  "You felt physically abused": "",
  "You had a heart attack (myocardial infarction) in hospital": "",
  "You had to be re-operated on urgently after your initial operation": "",
  "You had low blood pressure (hypotension)": "",
  "You had a reaction to a blood transfusion": "",
  "You had problems with your stoma": "",
  "You had a fall in hospital": "",
  "You needed to be transferred to intensive care because of a complication that occurred in hospital": "",
  "You noticed Inadequate staffing - nurses/doctor/other": "",
  "You required ongoing support with your breathing": "",
  "You suffered an unintended injury at the time of the operation": "",
  "You suffered a stroke (CVA)": "",
  "You were not monitored or followed-up as planned": "",
  "You were confused with another patient during a test or a treatment": "",
  "You were given a drug that was not intended for you": "",
  "You were given food/drink you were not allowed on your diet? (e.g. if you were nil by mouth)": "",
  "You were prescribed a drug you were allergic to": "",
  "You were prescribed an inappropriate choice of drug eg due to contraindication": "",
  "You were given an infusion or drug that was not intended for you.": "",
  "You were given an infusion or drug at the wrong time": "",
  "You were given an infusion or drug at the wrong dose": "",
  "You were addressed informally without your agreement": "",
  "You were not treated with dignity and respect by the doctors and nurses": "",
  "You were not explained how the ward works? (e.g. where the toilets are, what time meals are?)": "",
  "You were not given enough information about your care after discharge from hospital": "",
  "You were not explained about what to expect from your treatment while in hospital": "",
  "You were handled or moved with roughness": "",
  "You were pushed to undergo a test or a treatment against your wish": "",
  "Your anastomosis leaked after the operation": "",
  "Your bowels become blocked (obstruction)": "",
  "Your bowels did not work for a prolonged period (ileus)": "",
  "Your graft or bypass became occluded": "",
  "Your wound opened up unexpectedly (wound dehiscence)": "",
  "Your fluids in your drip were not changed when they should have been": "",
  "Your medical records were unavailable when needed": "",
  "Your diagnosis was not explained to you.": "",
  "Your consent was not obtained before a test or an intervention": "",
};

var colourClasses = {
  "Complications" : '',
  "Health care process problems" : 'process',
  "Interpersonal problems" : 'interpersonal',
  "Medication-related problems" : 'medication'
};


var questions = {
  "Complications" : {
    "During Operation" : {
      "A keyhole operation had to be converted to open" : "A keyhole or laparoscopic operation had to be converted to open",
      "You experienced a reaction to a drug" : "You experienced a reaction to a drug",
      "You suffered an injury at the time of the operation" : "You suffered an unintended injury at the time of the operation",
      "You had a stroke" : "You suffered a stroke (CVA)",
      "You had a heart attack" : "You had a heart attack (myocardial infarction) in hospital",
      "You bled a lot after an operation" : "You bled a lot after an operation or after a tube or drain was inserted into you",
      "An operation was performed on the wrong site of your body" : "A test, surgical intervention or therapy was performed on the wrong site of your body.",
      "Something was inappropriately left inside you" : "Something was inappropriately left inside you (retained foreign body)",
      "The wrong implant was use" : "The wrong implant or prosthesis was used"
    },
    "Post-Op" : {
      "Emergency" : {
        "You needed to be transferred to intensive care" : "You needed to be transferred to intensive care because of a complication that occurred in hospital",
        "You had to be re-operated on urgently after your initial operation" : "You had to be re-operated on urgently after your initial operation"
      },
      "Bleeding" : {
        "You bled a lot after an operation or after a tube or drain was inserted into you" : "You bled a lot after an operation or after a tube or drain was inserted into you",
        "You developed a collection of blood at the site of an operation or procedure" : "You developed a collection of blood (haematoma) or fluid (seroma) at the site of an operation or procedure"
      },
      "Infection" : {
        "Chest Infection" : "Pneumonia",
        "Infective Diarrhoea" : "C.diff colitis",
        "Sepsis" : "Sepsis / bacteraemia",
        "Urinary tract infection" : "Urinary tract infection",
        "Phlebitis" : "Phlebitis",
        "Wound infection" : "Wound infection",
        "Intra-abdominal abscess" : "Intra-abdominal abscess",
        "Skin infection" : "Cellulitis"
      },
      "Heart and Circulation" : {
        "You had a stroke" : "You suffered a stroke (CVA)",
        "You had a heart attack" : "You had a heart attack (myocardial infarction) in hospital",
        "You developed a blood clot" : "You developed a DVT (deep vein thrombosis) or PE (pulmonary embolism)",
        "Your graft or bypass became occluded" : "Your graft or bypass became occluded",
        "You had low blood pressure" : "You had low blood pressure (hypotension)",
        "You had a reaction to a blood transfusion" : "You had a reaction to a blood transfusion",
        "You had a heart attack" : "You had a heart attack (myocardial infarction) in hospital",
        "You had low blood pressure" : "You had low blood pressure (hypotension)"
      },
      "Skin" : {
        "You developed a sore arm or inflammation because of a drip" : "You developed a sore arm or inflammation because of a drip (intravenous line)",
        "Phlebitis" : "Phlebitis",
        "Wound infection" : "Wound infection",
        "Skin infection" : "Cellulitis",
        "Your wound opened up unexpectedly" : "Your wound opened up unexpectedly (wound dehiscence)",
        "You developed a pressure ulcer" : "You developed a pressure ulcer (skin wound) in hospital"
      },
      "Mood" : {
        "You developed worsened anxiety or depression" : "You developed worsened anxiety or depression"
      },
      "Abdomen" : {
        "You had problems with your stoma" : "You had problems with your stoma",
        "Your anastomosis leaked after the operation" : "Your anastomosis leaked after the operation",
        "Your bowels become blocked" : "Your bowels become blocked (obstruction)",
        "Your bowels did not work for a prolonged period" : "Your bowels did not work for a prolonged period (ileus)",
        "Wound infection" : "Wound infection",
        "Your wound opened up unexpectedly" : "Your wound opened up unexpectedly (wound dehiscence)"
      },
      "Chest" : {
        "You developed a blood clot" : "You developed a DVT (deep vein thrombosis) or PE (pulmonary embolism)",
        "You required ongoing support with your breathing" : "You required ongoing support with your breathing",
        "You developed a collapsed lung" : "You developed a collapsed lung or pneumothorax after a procedure",
        "Chest Infection" : "Pneumonia"
      },
      "Urine" : {
        "You developed problems passing urine" : "You developed problems passing urine (oliguria/ failure/ incontinence / retention)",
        "Urinary tract infection" : "Urinary tract infection"
      }
    }
  },
  "Health care process problems" : {
    "Problem with Test" : {
      "A test or procedure was interrupted by equipment malfunction" : "A test or procedure was interrupted by Equipment malfunction",
      "A test was cancelled by mistake" : "A test was cancelled by mistake",
      "A test was not done when it should have been" : "A test was not done when it should have been",
      "A test was repeated needlessly" : "A test was repeated needlessly, by mistake",
      "A test was performed on the wrong site of your body" : "A test, surgical intervention or therapy was performed on the wrong site of your body.",
      "An error occurred in a test result" : "An error occurred in a test result"
    },
    "Problem with Ward" : {
      "Problems with environment and amenities" : "Problems with environment and amenities. In what?",
      "You had a fall in hospital" : "You had a fall in hospital"
    },
    "Problem with Operation" : {
      "An operation was performed on the wrong site of your body" : "A test, surgical intervention or therapy was performed on the wrong site of your body.",
      "Something was inappropriately left inside you" : "Something was inappropriately left inside you (retained foreign body)",
      "The wrong implant was used" : "The wrong implant or prosthesis was used"
    },
    "Problem with Staff" : {
      "Doctors made a wrong diagnosis" : "Doctors made a wrong diagnosis",
      "Staff did not wash their hands or use alcohol gel before touching you" : "You discovered that staff did not wash their hands or use alcohol gel before touching you.",
      "You noticed Inadequate staffing - nurses/doctor/other" : "You noticed Inadequate staffing - nurses/doctor/other",
      "You were given food/drink you were not allowed (e.g. if you were nil by mouth)" : "You were given food/drink you were not allowed on your diet? (e.g. if you were nil by mouth)",
      "You were not monitored or followed-up as planned" : "You were not monitored or followed-up as planned",
      "Your fluids in your drip were not changed when they should have been" : "Your fluids in your drip were not changed when they should have been",
      "You did not receive enough painkillers" : "You did not receive enough painkillers"
    },
    "Waits and Delays" : {
      "Your medical records were unavailable when needed" : "Your medical records were unavailable when needed",
      "Staff were unable to obtain a blood sample" : "Staff were unable to obtain a blood sample",
      "You experienced unexplained waits and delays. In what? For how long?" : "You experienced unexplained waits and delays. In what? For how long?",
      "You were not monitored or followed-up as planned" : "You were not monitored or followed-up as planned",
      "Your fluids in your drip were not changed when they should have been" : "Your fluids in your drip were not changed when they should have been",
      "You did not receive enough painkillers" : "You did not receive enough painkillers"
    },
    "Wrong Management" : {
      "Doctors made a wrong diagnosis" : "Doctors made a wrong diagnosis",
      "A test, surgical intervention or therapy was performed on the wrong site of your body" : "A test, surgical intervention or therapy was performed on the wrong site of your body.",
      "The wrong implant was used" : "The wrong implant or prosthesis was used",
      "You were confused with another patient during a test or a treatment" : "You were confused with another patient during a test or a treatment",
      "You were given a drug that was not intended for you" : "You were given a drug that was not intended for you",
      "You were given food/drink you were not allowed (e.g. if you were nil by mouth)" : "You were given food/drink you were not allowed on your diet? (e.g. if you were nil by mouth)"
    }
  },
  "Medication-related problems" : {
    "You experienced a reaction to a drug" : "You experienced a reaction to a drug",
    "You were prescribed a drug you were allergic to" : "You were prescribed a drug you were allergic to",
    "You were prescribed an inappropriate choice of drug" : "You were prescribed an inappropriate choice of drug eg due to contraindication",
    "You were given medication that was not intended for you" : "You were given an infusion or drug that was not intended for you.",
    "You were given medication at the wrong time" : "You were given an infusion or drug at the wrong time",
    "You were given medication at the wrong dose" : "You were given an infusion or drug at the wrong dose",
    "Medication was omitted, by mistake" : "An infusion or drug was omitted, by mistake.",
    "There was a delay in giving you your medication" : "There was a delay in giving you your medication",
    "Failure to order drug" : "Failure to order drug"
  },
  "Interpersonal problems" : {
    "Dignity and Respect" : {
      "Doctors or nurses did not respect confidentiality" : "Doctors or nurses did not respect confidentiality",
      "Doctors or nurses ignored information you gave them" : "Doctors or nurses ignored information you gave them",
      "Doctors or nurses did not introduce themselves and explain who they were" : "Health care staff did not introduce themselves and explain who they were",
      "You did not feel that you could ask questions to doctors and nurses" : "You did not feel that you could ask questions to doctors and nurses if you wanted to",
      "You were addressed informally without your agreement" : "You were addressed informally without your agreement",
      "You were not treated with dignity and respect by the doctors and nurses" : "You were not treated with dignity and respect by the doctors and nurses"
    },
    "No Explanation" : {
      "Health care staff did not introduce themselves and explain who they were" : "Health care staff did not introduce themselves and explain who they were",
      "The purpose of the medication was not explained to you" : "The purpose of the medication was not explained to you",
      "The side effects of your medication were not explained to you" : "The side effects of your medication were not explained to you",
      "You were not explained how the ward works? (e.g. where the toilets are, what time meals are?" : "You were not explained how the ward works? (e.g. where the toilets are, what time meals are?)",
      "You were not given enough information about your care after discharge" : "You were not given enough information about your care after discharge from hospital",
      "You were not explained about what to expect from your treatment while in hospital" : "You were not explained about what to expect from your treatment while in hospital",
      "Your diagnosis was not explained to you" : "Your diagnosis was not explained to you."
    },
    "Rough Treatment" : {
      "You were handled or moved with roughness" : "You were handled or moved with roughness",
      "You felt physically abused" : "You felt physically abused"
    },
    "Consent" : {
      "Your consent was not obtained before a test or an intervention" : "Your consent was not obtained before a test or an intervention",
      "You were pushed to undergo a test or a treatment against your wish" : "You were pushed to undergo a test or a treatment against your wish"
    }
  }
};

var getAllLeaves = function(obj) {
    return isString(obj)
        ? obj
        : _.flatten(_.map(obj, getAllLeaves));
};

sanityTestQuestions = function() {
    var q1 = _.uniq(getAllLeaves(questions));
    var q2 = _.uniq(_.keys(additionalSearchTerms));

    _.each(_.difference(q1, q2), function(str) { console.log("In hierarchy but not main list : " + str); });
    _.each(_.difference(q2, q1), function(str) { console.log("In main list but not hierarchy : " + str); });
};

var contains = function(str, lowerSearchText) {
    return str.toLowerCase().indexOf(lowerSearchText) > -1;
};

var isString = function(obj) {
    return typeof obj == 'string' || obj instanceof String;
};

angular
    .module('patientApp', ['ngAnimate'])
    .controller('MainController', function($rootScope, $scope, $location) {
        // NB: $location is referenced but not used, without this the locationChangeSuccess does not fire.
        sanityTestQuestions();
        $scope.isLoggedIn = false;

        $scope.currentQuestionPath = [];
        $scope.holder = {}; // bypass the child scope databinding problem
        $scope.back = function() { window.history.back(); };

        var navigateTo = function(path) {
            window.setTimeout(function() {
                location.hash = "#/" + path;
            });
        };

        var toHomePageIfLoggedIn = function() {
            if ($scope.isLoggedIn) { // TODO replace with actual check
                navigateTo("");
                return true;
            }
        };

        var toLoginPageIfLoggedOut = function() {
            if (!$scope.isLoggedIn) { // TODO replace with actual check
                navigateTo("login");
                return true;
            }
        };

        var getSubmitUrl = function(text) {
            return "#/submit/" + encodeURIComponent(text);
        }

        var showQuestionsForPath = function(path) {
            $scope.currentQuestionPath = [];
            $scope.holder.searchText = "";
            $scope.promptToConfirmDischarge = false;

            var questionsAtPath = questions;

            for (var i = 0; i < path.length; i++) {
                var pathStep = decodeURIComponent(path[i]);
                if (!isString(questionsAtPath) && questionsAtPath.hasOwnProperty(pathStep)) {
                    $scope.currentQuestionPath.push(pathStep);
                    questionsAtPath = questionsAtPath[pathStep];
                }
            }

            var questionUrls = {};

            $.each(questionsAtPath, function(key, val) {
                console.log(key + ": " + val);
                questionUrls[key] = isString(val)
                    ? getSubmitUrl(val)
                    : "#/questions/" + _.map($scope.currentQuestionPath, encodeURIComponent).join('/') + "/" + encodeURIComponent(key);
            });
            $rootScope.pageTitle = $scope.currentQuestionPath[0] || "What would you like to report?";

            $scope.colourClasses = $scope.currentQuestionPath.length == 0
                ? _.values(colourClasses)
                : [ colourClasses[$scope.currentQuestionPath[0]] ];
            $scope.questionUrls = questionUrls;
            $scope.otherUrl = getSubmitUrl($scope.currentQuestionPath.join(' > ') + " > Other");
            $scope.searchIsVisible = true;
        };

        var routes = {
            "" : function() {
                if (toLoginPageIfLoggedOut())
                    return;
                navigateTo("questions");
            },
            "login" : function() {
                if (toHomePageIfLoggedIn())
                    return;
                $rootScope.pageTitle = "Enter Patient ID number";
            },
            "search" : function(routePath) {
                if (toLoginPageIfLoggedOut())
                    return;
                var searchText = decodeURIComponent(routePath[0]);
                var lowerSearchText = searchText.toLowerCase();
                var questionUrls = {};

                _.chain(additionalSearchTerms)
                    .map(function(val, key) { return { key: key, val: val }; })
                    .filter(function(obj) { return contains(obj.key, lowerSearchText) || contains(obj.val, lowerSearchText); })
                    .each(function(obj) {
                        questionUrls[obj.key] = getSubmitUrl(obj.key);
                    });

                $scope.searchResults = questionUrls;
                $scope.holder.searchText = searchText;
                $scope.searchIsVisible = true;
            },
            "questions" : function(routePath) {
                if (toLoginPageIfLoggedOut())
                    return;
                showQuestionsForPath(routePath);
            },
            "submit" : function(routePath) {
                if (toLoginPageIfLoggedOut())
                    return;
                $scope.questionText = _.map(routePath, decodeURIComponent).join(' > ');
            }
        };

        var onNewLocation = function(obj, oldUrl, newUrl) {
            var routePath = (location.hash || "#").substr(1).split("/").slice(1) || "";
            window.scroll(0,0);
            var route = routes[routePath[0]];
            if (route) {
                $scope.visual_state = routePath[0];
                route(routePath.slice(1));
            }
            else {
                navigateTo("");
            }
        };

        $rootScope.$on('$locationChangeSuccess', onNewLocation);
        onNewLocation();

        $scope.logIn = function() {
            // TODO login
            $scope.isLoggedIn = true;
            navigateTo("");
        };

        $scope.enterFreeText = function() {
            // TODO save result
            navigateTo("questions");
        };

        $scope.find = function() {
            navigateTo("search/" + encodeURIComponent($scope.holder.searchText));
        };

        $scope.discharge = function() {
            $scope.promptToConfirmDischarge = true;
        };

        $scope.cancelDischarge = function() {
            $scope.promptToConfirmDischarge = false;
        };

        $scope.confirmDischarge = function() {
            $scope.isLoggedIn = false;
            navigateTo("");
        };
    });
</script>
  </head>

  <body class="js-enabled" ng-controller="MainController">
    <script type="text/javascript">document.body.className = ((document.body.className) ? document.body.className + ' js-enabled' : 'js-enabled');</script>
    
    <header role="banner" id="global-header" class="with-proposition">
      <div class="header-wrapper">
        <div class="header-global">
          <div class="header-logo">
            <a href="#" id="logo" class="content">
              <img src="./marys-custom/checklist-on-white.png" width="35" height="31" alt=""> EPIC
            </a>
          </div>
        </div>
        <div class="header-proposition">
        <div class="content">
          <nav id="proposition-menu">
            <a href="#" id="proposition-name">
              
              Empowering Patients to Improve Care
            </a>
          </nav>
        </div>
      </div>

      </div>
    </header>
    <!--end header-->    

    <div id="global-header-bar" ng-class="{ searchIsVisible : searchIsVisible }">
      <div class="header-bar">
        <div class="inner-block">
          <div class="header-bar-inner">
          </div>
        </div>

          <form id="search" class="site-search" ng-if="searchIsVisible">
            <div class="content">
              <label for="site-search-text" class="visuallyhidden">Search</label>
              <input type="search" ng-model="holder.searchText" id="site-search-text" title="Search" class="js-search-focus search-text"
                  ng-change="find()"><input type="submit" class="submit search-submit" value="search" />
            </div>
          </form>

      </div>
    </div>
    <!--end global-header-bar-->

<main id="content" class="">
  <div ng-switch on="visual_state">

    <div class="validate step" ng-switch-default>
      <form ng-submit="logIn()">
        <header class="question-one">
            <h4>Log in</h4>
            <h1>What is the patient's study ID number?</h1>
        </header>

        <label for="" class="visuallyhidden">
            What is the patient's study ID number?
        </label>

        <div class="">
            <input type="text" id="NINO_NINO" name="NINO.NINO" value="" autocomplete="off" class="text  validate nino " data-validation-name="" data-validation-type="field" data-validation-rules="">
        </div>
        <p class="example">Example: ABC 123 P</p>

        <input type="submit" value="Continue" id="continue" class="u-color-white u-inline-block button next" />
      </form>
    </div>

    <div ng-switch-when="search">
      <form>
        <a class="back-to-previous" ng-click="back()">
            Back
        </a>
        <header class="question-one">
            <h1>Search results for "{{holder.searchText}}"</h1>
        </header>
        <a href="{{url}}" ng-repeat="(q, url) in searchResults" class="u-color-white button next question">{{q}}</a>
      </form>
    </div>

    <div ng-switch-when="questions">
      <form>
        <a class="back-to-previous" ng-if="currentQuestionPath.length > 0" ng-click="back()">
            Back
        </a>
        <header class="question-one">
            <h1>{{pageTitle}}</h1>
            <h3 ng-if="currentQuestionPath.length > 1">
                <span ng-repeat="q in currentQuestionPath" ng-if="!$first">
                    {{q}}
                    <span ng-if="!$last">&gt;</span>
                </span>
            </h3>
        </header>
        <a href="{{url}}" ng-repeat="(q, url) in questionUrls" class="u-color-white button next question {{colourClasses[ $index % (colourClasses.length)]}}">{{q}}</a>
        <a href="{{otherUrl}}" class="u-color-white button next question other">Other</a>

        <hr ng-if="currentQuestionPath.length == 0">

        <a href ng-click="discharge()" ng-if="currentQuestionPath.length == 0"
            class="u-color-white button next question discharge">I've been discharged</a>

        <a href ng-click="confirmDischarge()" ng-if="promptToConfirmDischarge"
            class="u-color-white button next question discharge">Please click to confirm discharge</a>

        <a href ng-click="cancelDischarge()" ng-if="promptToConfirmDischarge"
            class="u-color-white button next question discharge">Cancel discharge</a>

      </form>
    </div>

    <div ng-switch-when="submit">
      <form ng-submit="enterFreeText()">
        <header class="question-one">
            <h4>
                <a class="back-to-previous" ng-click="back()">
                    Back
                </a>
                &nbsp;
            </h4>
            <h2>
                <span>{{questionText}}</span>
            </h2>
            <h1>Please describe what happened</h1>
        </header>

        <label for="" class="visuallyhidden">
            Please describe what happened
        </label>

        <div class="">
            <textarea rows="4" id="NINO_NINO" name="NINO.NINO" value="" autocomplete="off" class="text validate u-full-width" data-validation-name="" data-validation-type="field" data-validation-rules=""></textarea> 
        </div>
        <p class="example">Example: I was given blood that didn't match my blood type - the nurses got mixed up and switched the bloods with someone else on the ward.</p>

        <input type="submit" value="Send your feedback" id="continue" class="u-color-white u-inline-block button next" />
      </form>
    </div>
  </div>
</main>

    <footer class="group js-footer" id="footer" role="contentinfo">
      <div class="footer-wrapper">

        <div class="footer-meta">
          <div>
            <h2 class="visuallyhidden">
              Support links
            </h2>
            <p>
                Â© copyright
                <a href="http://sastrugisoftware.com/">
                  Sastrugi Software
                </a>
            </p>
          </div>

        </div>
      </div>
    </footer>

    <!--end footer-->

    <div id="global-app-error" class="app-error hidden"></div>

    <script src="./gov-uk-files/govuk-template.js" type="text/javascript"></script>

    <script src="./gov-uk-files/cache-busting.js"></script>
<script src="./gov-uk-files/jquery-1.10.1.min.js"></script>
<script src="./gov-uk-files/mustache.js"></script>
<script src="./gov-uk-files/typeahead.js"></script>
<script src="./gov-uk-files/core.js"></script>
<script src="./gov-uk-files/countries.js"></script>
<script src="./gov-uk-files/messages.js"></script>
<script src="./gov-uk-files/validation.js"></script>
<script src="./gov-uk-files/forms.js"></script>
<script src="./gov-uk-files/onready.js"></script>
<script src="./gov-uk-files/local-fix.js"></script>


  
</body></html>
